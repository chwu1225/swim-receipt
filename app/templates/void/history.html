{% extends "base.html" %}

{% block title %}ä½œå»¢ç”³è«‹æ­·å²{% endblock %}

{% block content %}
<div class="card">
    <h2 class="card-title">ğŸ“‹ ä½œå»¢ç”³è«‹æ­·å²</h2>
</div>

<div class="card">
    {% if requests.items %}
    <table class="table">
        <thead>
            <tr>
                <th>æ”¶æ“šç·¨è™Ÿ</th>
                <th>é‡‘é¡</th>
                <th>ç”³è«‹äºº</th>
                <th>ç”³è«‹æ™‚é–“</th>
                <th>ç‹€æ…‹</th>
                <th>å¯©æ ¸äºº</th>
                <th>å¯©æ ¸æ™‚é–“</th>
                <th>å¯©æ ¸å‚™è¨»</th>
            </tr>
        </thead>
        <tbody>
            {% for req in requests.items %}
            <tr>
                <td>
                    <a href="{{ url_for('receipt.view', receipt_id=req.receipt_id) }}">
                        {{ req.receipt.receipt_no }}
                    </a>
                </td>
                <td>${{ req.receipt.amount|int }}</td>
                <td>{{ req.requester.full_name }}</td>
                <td>{{ req.requested_at.strftime('%m/%d %H:%M') if req.requested_at else '' }}</td>
                <td>
                    {% if req.status == 'pending' %}
                    <span class="badge badge-warning">å¾…å¯©æ ¸</span>
                    {% elif req.status == 'approved' %}
                    <span class="badge badge-success">å·²æ ¸å‡†</span>
                    {% else %}
                    <span class="badge badge-danger">å·²é§å›</span>
                    {% endif %}
                </td>
                <td>{{ req.reviewer.full_name if req.reviewer else '-' }}</td>
                <td>{{ req.reviewed_at.strftime('%m/%d %H:%M') if req.reviewed_at else '-' }}</td>
                <td>{{ req.review_note or '-' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% if requests.pages > 1 %}
    <div class="pagination">
        {% if requests.has_prev %}
        <a href="{{ url_for('void.history', page=requests.prev_num) }}">ä¸Šä¸€é </a>
        {% endif %}

        {% for page in requests.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
            {% if page %}
                {% if page == requests.page %}
                <span class="active">{{ page }}</span>
                {% else %}
                <a href="{{ url_for('void.history', page=page) }}">{{ page }}</a>
                {% endif %}
            {% else %}
            <span>...</span>
            {% endif %}
        {% endfor %}

        {% if requests.has_next %}
        <a href="{{ url_for('void.history', page=requests.next_num) }}">ä¸‹ä¸€é </a>
        {% endif %}
    </div>
    {% endif %}

    {% else %}
    <p class="text-center" style="padding: 2rem; color: #666;">ç›®å‰æ²’æœ‰ä½œå»¢ç”³è«‹ç´€éŒ„</p>
    {% endif %}
</div>

<a href="{{ url_for('void.index') }}" class="btn btn-secondary">è¿”å›</a>
{% endblock %}
